---
title: "Top-down systems biology workflow automation with KEGGscape and py2cytoscape"
author: "Kozo Nishida and Keiichiro Ono"
date: "April 3, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Note about this RMarkdown
This RMarkdown uses **Python3**, and needs R "reticulate" package.
Please run
```
install.packages("reticulate")
```
in your R shell before running this RMarkdown.

## Overview

This is an automation application of KEGGscape REST API to top-down systems biology approach.
FigureXXX is the workflow.

![top-down systems biology approach workflow](figures/fig1.png)

## Step0 (Installing dependent packages)
First of all we install the R and Python packages for this workflow.

```{r}
source("https://bioconductor.org/biocLite.R")

biocLite("ecoliLeucine")
biocLite("affy")
biocLite("limma")
```

```{python}
import os
os.system('pip install py2cytoscape')
```

## Step1 (Microarray preprocessing)
We use bioconductor **ecoliLeucine and affy** packages for the dataset preprocessing of this workflow.
**ecoliLeucine** package is ...
eset is ...

```{r}
library(ecoliLeucine)
library(affy)

data(ecoliLeucine)
eset <- rma(ecoliLeucine)
pData(eset)
```

## Step2 (Statistical analysis)

We use bioconductor **limma** package for statistical analysis of ...

```{r}
library(limma)
strain <- c("lrp-","lrp-","lrp-","lrp-","lrp+","lrp+","lrp+","lrp+")
design <- model.matrix(~factor(strain))
colnames(design) <- c("lrp-","lrp+vs-")
design

fit <- lmFit(eset, design)
fit <- eBayes(fit)
options(digits=2)
result <- topTable(fit, coef = 2, number = 40, adjust.method = "BH")
result
write.csv(result, file = "result.csv")
```

## Step3 (Visualization with Cytoscape)

### Importing all Escherichia coli K-12 MG1655 KEGG pathways with KEGGscape REST API

```{python}
import requests
import pandas as pd
from io import SrtingIO

r = requests.get('http://rest.kegg.jp/list/pathway/eco')
ecopathways = pd.read_table(StringIO(r.text), header=None)
for pathid in ecopathways[0]:
    requests.get('http://localhost:1234/keggscape/v1/' + i[5:])
```



## Step4 (Data integration and knowledge discovery)
