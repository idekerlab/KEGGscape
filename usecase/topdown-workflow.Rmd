---
title: "Top-down systems biology workflow automation with KEGGscape and py2cytoscape"
author: "Kozo Nishida and Keiichiro Ono"
date: "April 3, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Overview

This is an automation application of KEGGscape REST API to top-down systems biology approach.
FigureXXX is the workflow.

![top-down systems biology approach workflow](figures/fig1.png)

## Step0 (Installing dependent packages)
First of all we install the R and Python packages for this workflow.

```{r}
source("https://bioconductor.org/biocLite.R")

biocLite("ecoliLeucine")
biocLite("affy")
biocLite("limma")
```

```{python}
import os
os.system('pip install py2cytoscape')
```

## Step1 (Microarray preprocessing)
We use bioconductor **ecoliLeucine and affy** package for the dataset of this workflow.
**ecoliLeucine** package is ...

```{r}
library(ecoliLeucine)
library(affy)

data(ecoliLeucine)
eset <- rma(ecoliLeucine)
pData(eset)
```

## Step2 (Statistical analysis)

We use bioconductor **limma** package for statistical analysis of ...

```{r}
library(limma)
strain <- c("lrp-","lrp-","lrp-","lrp-","lrp+","lrp+","lrp+","lrp+")
design <- model.matrix(~factor(strain))
colnames(design) <- c("lrp-","lrp+vs-")
design

fit <- lmFit(eset, design)
fit <- eBayes(fit)
options(digits=2)
write.csv(topTable(fit, coef=2, n=40, adjust="BH"), file="../results/result.csv")

```

## Step3 (Visualization with Cytoscape)

```{python}
```


## Step4 (Data integration and knowledge discovery)
